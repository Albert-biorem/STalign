Search.setIndex({"docnames": ["README", "STalign", "index", "notebooks/merfish-allen3Datlas-alignment", "notebooks/merfish-xenium-alignment", "notebooks/xenium-heimage-alignment", "notebooks/xenium-starmap-alignment", "notebooks/xenium-xenium-alignment", "overview", "tutorials"], "filenames": ["README.md", "STalign.rst", "index.rst", "notebooks/merfish-allen3Datlas-alignment.ipynb", "notebooks/merfish-xenium-alignment.ipynb", "notebooks/xenium-heimage-alignment.ipynb", "notebooks/xenium-starmap-alignment.ipynb", "notebooks/xenium-xenium-alignment.ipynb", "overview.md", "tutorials.rst"], "titles": ["STalign Overview", "Functions", "Welcome to STalign\u2019s documentation!", "Aligning adult mouse coronal brain sections with the Allen Brain Altas", "Aligning full coronal sections of adult mouse brain from MERFISH and Xenium", "Aligning single-cell resolution breast cancer spatial transcriptomics data to corresponding H&amp;E staining image from Xenium", "Aligning partially matched coronal sections of adult mouse brain from Xenium and STARmap", "Aligning partially matched, serial, single-cell resolution breast cancer spatial transcriptomics data from Xenium", "STalign Overview", "Tutorials"], "terms": {"tool": [0, 1, 3, 8], "align": [0, 1, 2, 8, 9], "spatial": [0, 1, 2, 3, 4, 6, 8, 9], "transcriptom": [0, 1, 2, 3, 4, 6, 8, 9], "data": [0, 1, 2, 3, 4, 6, 8, 9], "stalign": [1, 3, 4, 5, 6, 7], "lddmm": [1, 2, 4, 5, 6, 7], "xi": [1, 3, 4, 5, 6, 7], "i": [1, 3, 4, 5, 6, 7], "xj": [1, 3, 4, 5, 6, 7], "j": [1, 3, 4, 5, 6, 7], "pointsi": [1, 5, 7], "none": [1, 3], "pointsj": [1, 5, 7], "l": [1, 3, 5, 7], "t": [1, 3, 4, 5, 6, 7], "A": [1, 3, 4, 5, 6, 7], "v": [1, 3, 4, 5, 6, 7], "xv": [1, 3, 4, 5, 6, 7], "500": [1, 5], "0": [1, 3, 4, 5, 6, 7], "p": 1, "2": [1, 3, 4, 5, 6, 7], "expand": 1, "nt": [1, 3], "3": [1, 3, 4, 5, 6, 7], "niter": [1, 3, 4, 5, 6, 7], "5000": 1, "diffeo_start": 1, "epl": 1, "2e": 1, "08": 1, "ept": 1, "epv": [1, 4, 5, 6, 7], "2000": [1, 5], "sigmam": [1, 3, 5, 6, 7], "1": [0, 1, 3, 4, 5, 6, 7, 8], "sigmab": [1, 3, 5, 6, 7], "sigmaa": [1, 3, 5, 6, 7], "5": [1, 3, 4, 5, 6, 7], "sigmar": 1, "500000": 1, "sigmap": 1, "20": [1, 3], "devic": [1, 3, 4, 5, 6, 7], "cpu": [1, 3, 4, 5, 6, 7], "dtype": [1, 3], "torch": [1, 3, 4, 5, 6, 7], "float64": [1, 3], "mub": [1, 3, 5, 6], "mua": [1, 3, 5], "run": [1, 4, 5, 6, 7], "between": [1, 3, 5], "pair": 1, "imag": [1, 2, 3, 4, 6, 7, 9], "thi": [1, 3, 4, 5, 6, 7], "jointli": 1, "estim": 1, "an": [1, 3, 4, 5, 6, 7], "affin": [1, 3, 5, 7], "transform": [1, 3, 4, 5, 6, 7], "diffeomorph": [0, 1, 8], "phi": [1, 4, 5, 6, 7], "The": [1, 3], "map": [0, 1, 3, 8], "off": 1, "form": 1, "x": [1, 3, 4, 5, 6, 7], "list": [1, 3, 7], "tensor": [1, 3, 5, 6, 7], "locat": [1, 3, 4, 6], "voxel": 1, "atla": [1, 3, 5], "channel": 1, "along": [1, 3, 5, 7], "first": [1, 3, 4, 5, 6, 7], "axi": 1, "target": [1, 3, 4, 5, 6, 7], "initi": [1, 3, 5, 7], "guess": [1, 3], "linear": [1, 4, 5, 6, 7], "2x2": 1, "default": [1, 3, 4, 5, 6, 7], "ident": [1, 3], "translat": [1, 5], "element": 1, "matrix": [1, 4, 5, 7], "either": [1, 5], "can": [1, 3, 4, 5, 6, 7], "specifi": [1, 3, 4, 6], "both": [1, 3, 4, 6, 7], "veloc": [1, 3], "field": 1, "pixel": [1, 3], "float": 1, "smooth": [1, 3], "scale": [1, 3, 5, 6, 7], "200": [1, 3, 7], "power": 1, "laplacian": 1, "regular": 1, "factor": 1, "size": [1, 3, 5], "around": [1, 3], "boundari": 1, "int": 1, "number": [1, 3], "timestep": 1, "integr": 1, "ignor": [1, 3], "you": [1, 3, 4, 5, 6, 7], "input": 1, "n": [1, 3], "set": [1, 3, 4, 5, 6, 7], "correspond": [1, 2, 3, 9], "point": [1, 3, 4, 5, 6, 7], "match": [1, 2, 3, 9], "iter": [1, 3], "gradient": [1, 3, 5, 7], "descent": [1, 3, 5, 7], "optim": 1, "onli": [1, 3, 4, 5, 6, 7], "befor": 1, "nonlinear": 1, "deform": [1, 4, 5, 6, 7], "step": [1, 3], "part": 1, "standard": [1, 3], "deviat": [1, 3], "term": 1, "gaussian": 1, "mixtur": 1, "model": [1, 3], "cost": 1, "gener": [1, 4, 5, 6, 7], "control": 1, "accuraci": [1, 3, 5, 7], "smaller": 1, "more": [1, 3, 5, 7], "accur": 1, "As": 1, "common": [0, 1, 8], "rule": 1, "thumb": 1, "could": 1, "chose": 1, "varianc": [1, 5], "your": [1, 3, 4, 5, 6, 7], "backtround": 1, "If": [1, 3, 4, 6], "miss": 1, "tissu": [1, 3, 5, 7], "we": [1, 3, 4, 5, 6, 7], "mai": [1, 7], "label": [1, 3], "some": [1, 5], "background": [1, 3, 5, 6], "enforc": 1, "here": [1, 3], "artifact": [1, 3, 5], "ar": [1, 3, 4, 5, 6, 7], "other": [1, 3, 4, 5, 6, 7], "lack": 1, "templat": 1, "mean": [1, 3], "smoother": 1, "result": [1, 3, 4, 5, 6, 7], "int_0": 1, "int_x": 1, "lv": 1, "dx": [1, 3, 4, 5, 7], "dt": 1, "sum_i": 1, "atlas_point_i": 1, "target_point_i": 1, "str": 1, "also": [1, 3, 4, 5, 6, 7], "cuda": 1, "type": [1, 3, 6], "whose": 1, "dimens": 1, "same": [1, 4, 5, 6, 7], "which": [1, 3, 7], "provid": [1, 7], "valu": [1, 3, 5, 7], "rgb": [1, 4, 5, 6, 7], "should": [1, 3], "grayscal": 1, "includ": 1, "done": 5, "metric": [0, 8], "better": [], "mu": [], "lddmm_3d_to_slic": [1, 2, 3], "25": [1, 3], "1e": 1, "06": [1, 5, 7], "10": [1, 3, 4, 5, 6, 7], "1000": [1, 4, 6, 7], "100000000": 1, "3d": [0, 1, 3, 8], "2d": 1, "slice": [1, 3], "check": [5, 7], "convert": [1, 3, 6, 7], "semilagrang": [], "l_t_from_point": [1, 2, 3, 5, 7], "comput": [1, 5, 7], "from": [1, 2, 3, 9], "6dof": 1, "need": [1, 3, 4, 5, 6, 7], "output": [1, 5, 7], "rconstruct": 1, "blockwiz": 1, "like": [1, 3, 5], "arrai": [1, 3, 4, 5, 6, 7], "nx2": 1, "describ": 1, "row": [1, 3, 6], "col": 1, "order": [1, 3, 7], "xy": 1, "vector": 1, "build_transform": [1, 2, 4, 5, 6, 7], "direct": [1, 3, 4, 5, 6, 7], "b": [1, 4, 6, 7], "creat": [1, 3, 5, 7], "sampl": [1, 5, 7], "time": [1, 5], "depend": [1, 3, 4, 5, 6, 7], "char": 1, "f": [1, 4, 5, 6, 7], "forward": 1, "backward": 1, "us": [0, 1, 3, 4, 5, 6, 7, 8], "meshgrid": [1, 3], "ij": [1, 3], "index": [1, 3], "style": 1, "keep": [1, 4, 5, 6, 7], "mehsgrid": 1, "format": [1, 3], "implement": [], "versu": [], "build_transform3d": [1, 2], "IN": [], "progress": [], "clip": [1, 2], "visual": [1, 3, 4, 5, 6, 7], "ic": 1, "extent_from_x": [1, 2, 3, 4, 5, 6, 7], "given": [1, 7], "extent": [1, 3, 4, 5, 6, 7], "4": [1, 3, 4, 5, 6, 7], "tupl": 1, "np": [1, 3, 4, 5, 6, 7], "imshow": [1, 3, 4, 5, 6, 7], "each": [1, 3, 4, 6, 7], "e": [1, 2, 9], "column": [1, 3], "xmin": 1, "xmax": 1, "ymin": 1, "ymax": 1, "fig": [0, 1, 3, 4, 5, 6, 7, 8], "ax": [1, 3, 4, 5, 6, 7], "plt": [1, 3, 4, 5, 6, 7], "subplot": [1, 3, 4, 5, 6, 7], "extentj": [1, 4, 5, 6, 7], "interp": [1, 2], "phii": [1, 4, 6, 7], "kwarg": [1, 3], "interpol": 1, "grid": [1, 4, 6, 7], "posit": [1, 3, 4, 5, 6, 7], "store": [1, 3, 7], "1d": [1, 5], "compon": 1, "convent": 1, "contain": [1, 3], "differ": 1, "dict": 1, "argument": [1, 3], "fed": 1, "nn": [1, 3], "grid_sampl": [1, 3], "out": [1, 4, 5, 6, 7], "resampl": 1, "defin": [1, 3], "align_corn": 1, "true": [1, 3, 5, 7], "librari": [1, 3, 4, 5, 6, 7], "interp3d": [1, 2, 3], "4d": 1, "make_scre": [1, 2], "w": [1, 3], "name": [1, 6], "6": [1, 3], "scree": 1, "plot": [1, 3, 4, 5, 6, 7], "eigenvalu": 1, "numpi": [1, 3, 4, 5, 6, 7], "descend": 1, "dataset": [0, 1, 3, 4, 5, 6, 7, 8], "origin": [1, 3, 4, 5, 6, 7], "Will": 1, "titl": [1, 3], "matplotlib": [1, 3, 4, 5, 6, 7], "figur": [1, 3, 4, 5, 6, 7], "handl": 1, "valueerror": 1, "larger": 1, "than": [1, 3, 5, 7], "normal": [1, 2, 5], "arr": 1, "t_min": 1, "t_max": 1, "linearli": 1, "two": [1, 3, 4, 5, 6, 7], "specif": 1, "lower": [1, 3], "bound": 1, "rang": [1, 3, 5, 7], "upper": [1, 3, 4, 5, 6, 7], "norm_arr": 1, "raster": [1, 2, 3, 4, 5, 6, 7], "y": [1, 3, 4, 5, 6, 7], "g": [1, 4, 5, 6, 7], "30": [1, 4, 5, 6, 7], "blur": [1, 3, 4], "draw": [1, 3], "10000": [1, 4, 5, 6, 7], "wavelet_magnitud": 1, "fals": [1, 3], "use_window": 1, "densiti": [1, 3, 4, 5, 6, 7], "length": 1, "cell": [0, 1, 2, 3, 4, 6, 8, 9], "rna": 1, "count": 1, "unit": [1, 3, 4, 5, 6, 7], "kernel": 1, "aus": 1, "do": 1, "multi": 1, "area": 1, "beyond": 1, "everi": 1, "its": 1, "bool": 1, "take": [1, 3, 5, 7], "absolut": 1, "when": 1, "option": [1, 3, 7], "sort": 1, "greatest": 1, "least": 1, "m": [1, 5, 7], "len": 1, "drawn": 1, "except": 1, "micron": [1, 4, 5, 6, 7], "three": 1, "rasterizepca": [1, 2], "perform": [1, 3, 4, 5, 6, 7], "pca": 1, "panda": [1, 3, 4, 5, 6, 7], "datafram": 1, "shape": [1, 3, 5, 7], "gene": 1, "express": [1, 3], "level": [1, 4, 5, 6, 7], "unravel": 1, "d": [1, 3], "center": 1, "princip": 1, "eigenvector": 1, "z": [1, 3, 6], "rotat": [1, 3], "nrow": 1, "ncol": 1, "all": [1, 3, 4, 5, 6, 7], "rasterize_with_sign": [1, 2], "": [1, 3, 4, 5, 6, 7], "signal": 1, "nxm": 1, "last": 1, "saverast": [1, 2], "scree_fig": 1, "path": [1, 3, 4, 5, 6, 7], "save": [1, 3, 5, 7], "necessari": 1, "jpeg": 1, "folder": [1, 3, 4, 5, 6, 7], "where": [1, 3], "file": [1, 3, 4, 5, 6, 7], "to_a": [1, 2], "NOT": 1, "2x1": 1, "to_a_3d": [1, 2], "3x3": 1, "transform_image_atlas_to_target": [1, 2, 4, 6, 7], "transform_image_target_to_atla": [1, 2, 4, 5, 6, 7], "transform_points_atlas_to_target": [1, 2, 7], "transform_points_target_to_atla": [1, 2, 4, 5, 6, 7], "v_to_phii": [1, 2], "over": 1, "5d": 1, "v0": 1, "v1": 1, "invers": 1, "method": 1, "characterist": 1, "v_to_phii_3d": [1, 2], "v2": [1, 3], "overview": 2, "usag": [2, 7], "tutori": 2, "function": [2, 3], "python": [0, 7, 8], "st": [0, 8], "biorxiv": [0, 5, 7, 8], "link": [0, 1, 3, 8], "enabl": [0, 8], "singl": [0, 2, 3, 4, 6, 8, 9], "resolut": [0, 2, 3, 4, 6, 8, 9], "within": [0, 8], "technologi": [0, 3, 5, 7, 8], "histologi": [0, 8], "across": [0, 5, 8], "coordin": [0, 1, 4, 5, 6, 7, 8], "framework": [0, 8], "To": [0, 3, 5, 7, 8], "pleas": [0, 8], "refer": [0, 3, 8], "follow": [0, 3, 7, 8], "jupytr": [0, 8], "notebook": [0, 3, 4, 5, 6, 7, 8], "exampl": [0, 3, 8], "partial": [2, 9], "serial": [2, 3, 9], "breast": [2, 3, 9], "cancer": [2, 3, 9], "xenium": [2, 3, 9], "In": [3, 4, 5, 6, 7], "profil": [3, 5, 7], "them": [3, 5, 7], "download": [3, 4, 5, 6, 7], "addit": 3, "merfish": 3, "find": 3, "detail": [3, 5, 7], "about": [3, 5, 7], "http": [3, 5, 7], "info": 3, "vizgen": 3, "com": [3, 5, 7], "achiev": [3, 4, 5, 6, 7], "load": [3, 4, 5, 6, 7], "relev": [3, 4, 5, 6, 7], "code": [3, 4, 5, 6, 7], "import": [3, 4, 5, 6, 7], "pyplot": [3, 4, 5, 6, 7], "pd": [3, 4, 5, 6, 7], "csv": [3, 4, 5, 6, 7], "cm": 3, "line": [3, 4, 5, 6, 7], "line2d": 3, "o": 3, "exist": 3, "split": 3, "join": 3, "splitext": 3, "makedir": 3, "glob": 3, "request": 3, "collect": [3, 4, 5, 6, 7], "defaultdict": 3, "nrrd": 3, "tornado": 3, "sy": [3, 4, 5, 6, 7], "insert": 3, "py": [3, 4, 5, 6, 7], "copi": [3, 5, 7], "have": [3, 4, 5, 6, 7], "alreadi": [3, 4, 5, 6, 7], "found": 3, "abov": 3, "call": [3, 4, 5, 6, 7], "merfish_data": [3, 4, 6], "now": [3, 4, 5, 6, 7], "read": [3, 4, 5, 6, 7], "infom": 3, "must": 3, "variabl": 3, "respect": [3, 7], "importantli": 3, "approxim": [3, 4, 6], "um": [3, 4, 5, 6, 7], "filenam": 3, "__": 3, "df": [1, 3, 5], "read_csv": [3, 4, 5, 6, 7], "s1r1_metadata": 3, "gz": [3, 4, 5, 6, 7], "center_x": [3, 4], "chang": 3, "center_i": [3, 4], "ontologi": [1, 3], "region": [1, 3], "annot": [1, 3], "aforement": 3, "would": 3, "url": [1, 3], "p56": 3, "api": 3, "org": [3, 5, 7], "queri": 3, "criteria": 3, "structur": 3, "rma": 3, "ontology_id": 3, "eq1": 3, "eq": 3, "27structur": 3, "graph_ord": 3, "27": 3, "num_row": 3, "eqal": 3, "ontology_nam": [1, 3], "namesdict": [1, 3], "download_aba_ontologi": [1, 2, 3], "allen_ontologi": 3, "lt": [3, 4, 5, 6, 7], "respons": 3, "gt": [3, 4, 5, 6, 7], "7": 3, "imageurl": [1, 3], "alleninstitut": 3, "informat": 3, "archiv": 3, "current": 3, "releas": 3, "mouse_ccf": 3, "ara_nissl": 3, "ara_nissl_50": 3, "labelurl": [1, 3], "ccf_2017": 3, "annotation_50": 3, "imagefil": [1, 3], "labelfil": [1, 3], "download_aba_image_label": [1, 2, 3], "aba_nissl": 3, "aba_annot": 3, "our": [3, 4, 5, 6, 7], "centroid": [3, 4, 5, 6, 7], "For": [3, 4, 5, 6, 7], "choos": 3, "15": [3, 4, 5, 6], "8": [3, 6], "x_": [1, 3], "y_": [1, 3], "9": [3, 6], "unraster": 3, "scatter": [3, 4, 5, 6, 7], "alpha": [3, 4, 5, 6, 7], "invert_yaxi": [3, 4, 5, 6, 7], "set_titl": [3, 4, 5, 6, 7], "set_aspect": [3, 4, 5, 6, 7], "equal": [3, 4, 5, 6, 7], "canva": 3, "savefig": 3, "outnam": 3, "_imag": 3, "png": [3, 5], "text": [3, 5, 7], "39": [3, 5, 7], "evalu": [3, 4, 5, 6, 7], "whether": [3, 4, 5, 6, 7], "similar": [3, 5, 6], "view": 3, "side": 3, "comparison": 3, "aba": 3, "anterior": 3, "264": 3, "posterior": 3, "perus": 3, "through": 3, "177": 3, "vol": 3, "hdr": 3, "dxa": 3, "diag": 3, "space": 3, "nxa": 3, "xa": 3, "arang": [3, 4, 5, 6, 7], "zip": 3, "extenta": 3, "next": [3, 4, 5, 6, 7], "angl": 3, "theta_deg": 3, "note": [3, 4, 5, 6, 7], "degre": 3, "11": [3, 5], "scipi": 3, "ndimag": 3, "ani": [3, 5], "eachoth": 3, "add": 3, "help": [3, 7], "speed": 3, "up": 3, "12": [3, 4, 5, 6, 7], "points_atla": 3, "2580": 3, "points_target": 3, "2533": 3, "li": 3, "ti": 3, "well": [3, 7], "13": 3, "ab": 3, "keepdim": 3, "concaten": 3, "chosen": 3, "readi": 3, "paramet": [3, 4, 5, 6, 7], "relat": 3, "14": 3, "intens": [3, 5], "inten": 3, "averag": 3, "look": [3, 5, 7], "histogram": 3, "below": 3, "consid": 3, "present": 3, "absent": 3, "usual": 3, "doe": 3, "hist": 3, "ravel": 3, "xlabel": 3, "ylabel": 3, "vari": 3, "durat": 3, "ensur": 3, "invert": [3, 4, 5, 6, 7], "minimum": 3, "error": 3, "16": [3, 5, 6], "scale_x": [1, 3], "scale_i": [1, 3], "scale_z": 3, "theta0": 3, "pi": 3, "180": [3, 5, 7], "get": [3, 4, 5, 6, 7], "local": [3, 4, 5, 6, 7], "els": 3, "scale_atla": 3, "co": 3, "sin": 3, "matmul": 3, "17": [3, 6], "return": 3, "mat": 3, "home": 3, "manju": 3, "anaconda3": 3, "env": 3, "stalign_ma": 3, "lib": 3, "python3": 3, "site": 3, "packag": 3, "504": 3, "userwarn": [3, 5, 7], "upcom": 3, "requir": 3, "pass": 3, "trigger": 3, "intern": 3, "aten": 3, "src": 3, "nativ": 3, "tensorshap": 3, "cpp": 3, "3190": 3, "_vf": 3, "attr": 3, "document": 3, "1619": 3, "ha": [3, 5, 7], "therefor": [3, 5, 7], "cannot": [3, 5, 7], "log": [3, 5, 7], "set_yscal": [3, 5, 7], "onc": 3, "project": 3, "export": 3, "inform": [1, 3, 4, 5, 6, 7], "18": [3, 6], "analyze3dalign": [1, 2, 3], "1726": 3, "construct": [3, 5, 7], "recommend": [3, 5, 7], "sourcetensor": [3, 5, 7], "clone": [3, 5, 7], "detach": [3, 5, 7], "requires_grad_": [3, 5, 7], "rather": [3, 5, 7], "1727": 3, "1739": 3, "19": 3, "coord0": 3, "coord1": 3, "coord2": 3, "struct_id": 3, "acronym": 3, "2539": 3, "515486": 3, "603": [3, 4], "193661": 3, "5240": 3, "542771": 3, "156": 3, "563284": 3, "4271": 3, "326432": 3, "bg": 3, "647117": 3, "592": 3, "013787": 3, "662749": 3, "509284": 3, "4256": 3, "962431": 3, "2540": 3, "042012": 3, "558": 3, "474157": 3, "5241": 3, "022683": 3, "159": 3, "965284": 3, "4228": 3, "180431": 3, "2538": 3, "604705": 3, "670": 3, "107819": 3, "5228": 3, "182084": 3, "167": 3, "579284": 3, "4323": 3, "868433": 3, "988970": 3, "647": 3, "913143": 3, "062863": 3, "160": 3, "559284": 3, "4308": 3, "802433": 3, "78324": 3, "2422": 3, "949259": 3, "666": 3, "416827": 3, "5225": 3, "134162": 3, "9154": 3, "007886": 3, "4445": 3, "528506": 3, "78325": 3, "2423": 3, "861142": 3, "644": 3, "950717": 3, "5155": 3, "140278": 3, "9088": 3, "829884": 3, "4423": 3, "712505": 3, "78326": 3, "014052": 3, "643": 3, "726655": 3, "5248": 3, "138969": 3, "9170": 3, "261887": 3, "4431": 3, "758506": 3, "78327": 3, "999558": 3, "633": 3, "758279": 3, "017523": 3, "9086": 3, "183884": 3, "4417": 3, "016505": 3, "78328": 3, "2424": 3, "194181": 3, "634": 3, "061413": 3, "5131": 3, "766050": 3, "9073": 3, "169884": 3, "4419": 3, "770505": 3, "78329": 3, "explor": 3, "overlai": 3, "It": 3, "ai": 3, "permut": [3, 4, 5, 6, 7], "padding_mod": 3, "border": 3, "ishow_sourc": 3, "amin": 3, "amax": 3, "jt": 3, "ishow_target": 3, "max": [3, 4, 5, 6, 7], "item": 3, "mpl": 3, "figsiz": [3, 4, 5, 6, 7], "ax0": 3, "cmap": 3, "blue": 3, "ax1": 3, "red": [3, 5, 7], "ax2": 3, "show": [3, 4, 5, 6, 7], "curv": 3, "captur": 3, "trueli": 3, "natur": [3, 5], "21": [3, 6], "plotli": 3, "graph_obj": 3, "go": 3, "px": 3, "scatter_3d": 3, "update_layout": 3, "update_xax": 3, "show_grid": 3, "update_yax": 3, "update_trac": 3, "marker_s": 3, "22": [3, 6], "plot_brain_region": [1, 2, 3], "interest": [1, 3], "few": [3, 7], "let": 3, "visp4": 3, "visp5": 3, "those": 3, "24": [3, 5, 7], "brain_region": [1, 3], "plot_subset_brain_region": [1, 2, 3], "section": [2, 5, 7, 9], "see": [5, 7], "preprint": [5, 7], "www": [5, 7], "content": [5, 7], "1101": [5, 7], "2022": [5, 7], "510405v2": [5, 7], "accord": 5, "author": 5, "due": 5, "non": [4, 5, 6, 7], "destruct": 5, "workflow": 5, "were": [1, 4, 5, 6, 7], "abl": 5, "post": 5, "process": 5, "howev": 5, "wa": 5, "seprat": 5, "still": [5, 7], "regist": 5, "directori": [4, 5, 6, 7], "skip": [4, 5, 6, 7], "append": [4, 5, 6, 7], "make": [4, 5, 6, 7], "bigger": [4, 5, 6, 7], "rcparam": [4, 5, 6, 7], "place": [4, 5, 6, 7], "xenium_data": [4, 5, 6, 7], "10xgenom": [5, 7], "product": [5, 7], "situ": [5, 7], "preview": [5, 7], "human": [5, 7], "73": [4, 5, 7], "image_fil": 5, "xenium_ffpe_human_breast_cancer_rep1_he_imag": 5, "imread": 5, "axesimag": 5, "0x7f813041e040": 5, "had": 5, "nxmx3": 5, "74": [4, 5, 7], "print": [4, 5, 6, 7], "min": 5, "2051": 5, "2759": 5, "case": 5, "outlier": 5, "75": [4, 5, 7], "inorm": 5, "0x7f81115c3490": 5, "transpos": [4, 5, 6, 7], "3xnxm": 5, "downstream": [5, 7], "analys": 5, "yi": [4, 5, 6, 7], "track": 5, "76": [4, 5], "long": 5, "doubl": [1, 5, 7], "later": [4, 5, 6, 7], "so": [4, 5, 6, 7], "multipli": 5, "extenti": [4, 5, 6, 7], "77": 5, "fname": [4, 5, 6, 7], "xenium_ffpe_human_breast_cancer_rep1_cel": [5, 7], "head": [4, 5, 6, 7], "cell_id": [5, 6, 7], "x_centroid": [4, 5, 6, 7], "y_centroid": [4, 5, 6, 7], "transcript_count": [5, 6, 7], "control_probe_count": [5, 6, 7], "control_codeword_count": [5, 6, 7], "total_count": [5, 6, 7], "cell_area": [5, 6, 7], "nucleus_area": [5, 6, 7], "377": [5, 7], "663005": [5, 7], "843": [5, 7], "541888": [5, 7], "154": [5, 7], "110": [5, 7], "361875": [5, 7], "45": [5, 7], "562656": [5, 7], "382": [5, 7], "078658": [5, 7], "858": [5, 7], "944818": [5, 7], "64": [5, 7], "87": [4, 5, 7], "919219": [5, 7], "248906": [5, 7], "319": [5, 7], "839529": [5, 7], "869": [5, 7], "196542": [5, 7], "57": [5, 7], "52": [4, 5, 6, 7], "561875": [5, 7], "23": [5, 7], "526406": [5, 7], "259": [5, 7], "304707": [5, 7], "851": [5, 7], "797949": [5, 7], "120": [5, 7], "230312": [5, 7], "35": [5, 7], "176719": [5, 7], "370": [5, 7], "576291": [5, 7], "865": [5, 7], "193024": [5, 7], "218594": [5, 7], "34": [5, 7], "499375": [5, 7], "pull": [4, 5, 6, 7], "further": [4, 5, 6, 7], "sens": [4, 5, 6, 7], "variat": [4, 5, 6, 7], "reli": [4, 5, 6, 7], "89": [4, 5], "xm": 5, "ym": 5, "pathcollect": [4, 5, 6, 7], "0x7f80d0d39f40": 5, "94": 5, "0x7f8132312ac0": 5, "begin": 5, "assum": [4, 5, 6, 7], "bottom": [4, 5, 6, 7], "left": [4, 5, 6, 7], "while": [4, 5, 6, 7], "typic": [4, 5, 6, 7], "top": [4, 5, 6, 7], "ve": [4, 5, 6, 7], "yaxi": [4, 5, 6, 7], "consist": [4, 5, 6, 7], "80": 5, "30um": [4, 5, 6, 7], "yj": [4, 5, 6, 7], "167782": [5, 7], "20000": [4, 5, 6, 7], "30000": [4, 5, 6, 7], "40000": [4, 5, 6, 7], "50000": [4, 5, 6, 7], "60000": [4, 5, 6, 7], "70000": [4, 5, 6, 7], "80000": [4, 5, 6, 7], "90000": [4, 5, 6, 7], "100000": [4, 5, 6, 7], "110000": [4, 5, 6, 7], "120000": [4, 5, 6, 7], "130000": [4, 5, 6, 7], "140000": [4, 5, 6, 7], "150000": [4, 5, 6, 7], "160000": [4, 5, 6, 7], "167781": [5, 7], "greyscal": [4, 5, 6, 7], "simpli": 5, "stack": [4, 5, 6, 7], "81": 5, "vstack": [4, 5, 6, 7], "thing": 5, "201": 5, "276": 5, "134067631252947": 5, "inter": [5, 7], "somewhat": [5, 7], "slow": [5, 7], "manual": [5, 7], "mark": 5, "landmark": [5, 7], "simpl": [5, 7], "sensibl": [5, 7], "197": 5, "1050": 5, "950": 5, "700": 5, "2200": 5, "1550": 5, "1840": 5, "3108": 5, "2100": 5, "4480": 5, "6440": 5, "5040": 5, "4200": 5, "1260": 5, "5320": 5, "squeez": [4, 5, 6, 7], "c": [4, 5, 6, 7], "198": 5, "base": 5, "appli": [4, 5, 6, 7], "deriv": 5, "linalg": 5, "inv": 5, "shift": 5, "neg": 5, "subtract": 5, "instead": [4, 5, 6, 7], "ad": 5, "199": 5, "dot": 5, "xmaffin": 5, "ymaffin": 5, "65041156": 5, "06574554": 5, "11365427": 5, "50866925": 5, "6832": 5, "39702429": 5, "1329": 5, "64577839": 5, "0x7f80c939b790": 5, "seem": 5, "distort": [5, 7], "introduc": 5, "dure": 5, "suffici": [5, 7], "via": [5, 7], "There": [4, 5, 6, 7], "mani": [4, 5, 6, 7], "tune": [4, 5, 6, 7], "84": [4, 5], "my": [4, 5, 6, 7], "desktop": [4, 5, 6, 7], "param": [4, 5, 6, 7], "black": [5, 6], "white": 5, "1283": [5, 7], "throughout": [4, 5, 6, 7], "give": [4, 5, 6, 7], "choic": [4, 5, 6, 7], "appropri": [4, 5, 6, 7], "converg": [4, 5, 6, 7], "solut": [4, 5, 6, 7], "how": [4, 5, 6, 7], "sourc": [4, 5, 6, 7], "85": [4, 5], "phiij": [4, 5, 6, 7], "phiipointsj": [5, 7], "contour": [4, 5, 6, 7], "color": [1, 4, 5, 6, 7], "r": [4, 5, 6, 7], "linestyl": [4, 5, 6, 7], "1638": [5, 7], "1639": [5, 7], "1651": [5, 7], "0x7f80c1a66340": 5, "final": [4, 5, 6, 7], "new": [4, 5, 6, 7], "86": [4, 5], "tpointsi": [4, 5, 6, 7], "And": [4, 5, 6, 7], "0x7f81115e88b0": 5, "hstack": [5, 7], "savetxt": [5, 7], "88": 5, "xenium_breast_cancer_rep1_stalign_to_h": 5, "delimit": [5, 7], "gzip": [5, 7], "compress": [5, 7], "51": [4, 6, 7], "df1": [4, 6, 7], "0x7f7d18cb0d00": 7, "54": 7, "repeat": [4, 6, 7], "second": [4, 6, 7], "xenium_ffpe_human_breast_cancer_rep2_cel": 7, "df2": [4, 6, 7], "ff7f0e": [4, 6, 7], "118752": 7, "118751": 7, "79": 7, "0x7f7cc8a3ed30": 7, "design": 7, "curve_annot": 7, "script": 7, "assist": 7, "write": 7, "npz": 7, "picker": 7, "savez": 7, "xenium_breast_cancer_rep1": 7, "xenium_breast_cancer_rep2": 7, "graphic": 7, "user": 7, "interfac": 7, "select": 7, "xenium_breast_cancer_rep1_point": 7, "npy": 7, "xenium_breast_cancer_rep2_point": 7, "58": 7, "pointsilist": 7, "allow_pickl": 7, "tolist": 7, "pointsjlist": 7, "2065": 7, "0390375683187": 7, "3096": 7, "538441761356": 7, "6505": 7, "52290853606": 7, "4365": 7, "248119180711": 7, "4226": 7, "85355369735": 7, "4932": 7, "828764342001": 7, "2365": 7, "8569852416354": 7, "1218": 7, "8582693193312": 7, "6839": 7, "7279529835705": 7, "2387": 7, "4066564161058": 7, "4552": 7, "711823951313": 7, "3046": 7, "801817706428": 7, "want": [4, 7], "59": 7, "jean": 7, "bit": 7, "odd": 7, "me": 7, "orient": 7, "kei": 7, "60": 7, "53844176": 7, "03903757": 7, "24811918": 7, "52290854": 7, "82876434": 7, "8535537": 7, "85826932": 7, "85698524": 7, "40665642": 7, "72795298": 7, "80181771": 7, "71182395": 7, "altern": 7, "just": [4, 6, 7], "But": 7, "good": 7, "61": [6, 7], "201x276": [4, 7], "62": 7, "63": [6, 7], "100": [6, 7], "ifoo": [4, 6, 7], "jfoo": [4, 6, 7], "phipointsi": 7, "becaus": [4, 6, 7], "65": [6, 7], "66": 7, "tpointsj": [4, 6, 7], "67": 7, "0x7f7d1867a400": 7, "68": 7, "xenium_breast_cancer_rep2_stalign_to_rep1": 7, "h": [2, 9], "stain": [1, 2, 9], "adult": [2, 9], "mous": [2, 9], "coron": [2, 9], "brain": [1, 2, 9], "allen": [2, 9], "alta": [1, 2, 9], "oct": [], "starmap": [2, 9], "assai": [4, 6], "datasets_mouse_brain_map_brainreceptorshowcase_slice2_replicate3_cell_metadata_s2r3": 4, "unnam": 4, "fov": 4, "volum": 4, "158338042824236264719696604356349910479": 4, "33": 4, "532": 4, "778772": 4, "617": 4, "916619": 4, "260594727341160372355976405428092853003": 4, "1004": 4, "430016": 4, "596": 4, "808018": 4, "307643940700812339199503248604719950662": 4, "1267": 4, "183208": 4, "578": 4, "880018": 4, "30863303465976316429997331474071348973": 4, "1403": 4, "401822": 4, "572": 4, "616017": 4, "313162718584097621688679244357302162401": 4, "507": 4, "949497": 4, "608": 4, "364018": 4, "min_x": 4, "max_x": 4, "min_i": 4, "max_i": 4, "2666": 4, "520010": 4, "614": 4, "725219": 4, "621": 4, "108019": 4, "2657": 4, "545209": 4, "2675": 4, "494810": 4, "2763": 4, "450012": 4, "589": 4, "669218": 4, "946818": 4, "2757": 4, "013212": 4, "2769": 4, "886812": 4, "2748": 4, "978012": 4, "570": 4, "877217": 4, "586": 4, "882818": 4, "2740": 4, "489211": 4, "466812": 4, "2766": 4, "690012": 4, "564": 4, "937217": 4, "580": 4, "294818": 4, "2756": 4, "581212": 4, "2776": 4, "798812": 4, "2687": 4, "418010": 4, "061218": 4, "613": 4, "666818": 4, "2682": 4, "493210": 4, "2692": 4, "342810": 4, "0x7fef530a12e0": 4, "85958": 4, "85957": 4, "xenium_v1_ff_mouse_brain_multisection_1_cel": [4, 6], "162033": [4, 6], "162032": [4, 6], "0x7fef530a8850": 4, "don": [4, 6], "50": [4, 6], "0x7fef9398e580": 4, "itself": 4, "90": 4, "0x7fefb0cf4a60": 4, "0x7fefa0270550": 4, "full": 6, "hemi": 6, "1557": 6, "532239": 6, "2528": 6, "022437": 6, "327": 6, "1560": 6, "669312": 6, "2543": 6, "632678": 6, "354": 6, "1570": 6, "462885": 6, "2530": 6, "810461": 6, "422": 6, "1573": 6, "927734": 6, "2546": 6, "454529": 6, "250": 6, "1581": 6, "344379": 6, "2557": 6, "024951": 6, "550": 6, "240": 6, "953750": 6, "038125": 6, "211": 6, "692500": 6, "476562": 6, "186": 6, "946875": 6, "69": 6, "540625": 6, "239": 6, "237812": 6, "728594": 6, "552": 6, "438": 6, "692969": 6, "92": 6, "209063": 6, "0x7fb110b96730": 6, "starmap_data": 6, "well11_spati": 6, "skiprow": 6, "tissue_symbol": 6, "well11_0": 6, "10834": 6, "272727": 6, "1488": 6, "454545": 6, "242424": 6, "l1_hpfmo": 6, "well11_1": 6, "12139": 6, "406780": 6, "864": 6, "788136": 6, "389831": 6, "mening": 6, "well11_2": 6, "11848": 6, "132075": 6, "1225": 6, "679245": 6, "528302": 6, "well11_3": 6, "11090": 6, "980392": 6, "1342": 6, "539216": 6, "637255": 6, "well11_4": 6, "11517": 6, "905660": 6, "1351": 6, "735849": 6, "113208": 6, "maintype_symbol": 6, "subtype_symbol": 6, "vascular": 6, "leptomening": 6, "vlm_1": 6, "vlm_2": 6, "telencephalon": 6, "inhibitori": 6, "interneuron": 6, "teinh_9": 6, "flip": 6, "0x7fb0f09a29d0": 6, "43341": 6, "43340": 6, "0x7fb0b2f49f10": 6, "49": 6, "53": 6, "0x7fb0d65a5eb0": 6, "file_nam": 1, "dictionari": 1, "rgeion": 1, "subset": 1, "ca1": 1, "cp": 1, "dg": 1, "sg": 1}, "objects": {"": [[1, 0, 0, "-", "STalign"]], "STalign": [[1, 1, 1, "", "LDDMM"], [1, 1, 1, "", "LDDMM_3D_to_slice"], [1, 1, 1, "", "L_T_from_points"], [1, 1, 1, "", "analyze3Dalign"], [1, 1, 1, "", "build_transform"], [1, 1, 1, "", "build_transform3D"], [1, 1, 1, "", "clip"], [1, 1, 1, "", "download_aba_image_labels"], [1, 1, 1, "", "download_aba_ontology"], [1, 1, 1, "", "extent_from_x"], [1, 1, 1, "", "interp"], [1, 1, 1, "", "interp3D"], [1, 1, 1, "", "make_scree"], [1, 1, 1, "", "normalize"], [1, 1, 1, "", "plot_brain_regions"], [1, 1, 1, "", "plot_subset_brain_regions"], [1, 1, 1, "", "rasterize"], [1, 1, 1, "", "rasterizePCA"], [1, 1, 1, "", "rasterize_with_signal"], [1, 1, 1, "", "saveRasters"], [1, 1, 1, "", "to_A"], [1, 1, 1, "", "to_A_3D"], [1, 1, 1, "", "transform_image_atlas_to_target"], [1, 1, 1, "", "transform_image_target_to_atlas"], [1, 1, 1, "", "transform_points_atlas_to_target"], [1, 1, 1, "", "transform_points_target_to_atlas"], [1, 1, 1, "", "v_to_phii"], [1, 1, 1, "", "v_to_phii_3D"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"function": 1, "paramet": 1, "return": 1, "todo": [], "exampl": 1, "note": 1, "rais": 1, "paramt": 1, "welcom": 2, "stalign": [0, 2, 8], "": 2, "document": 2, "content": 9, "overview": [0, 8], "usag": [0, 8], "tutori": 9, "align": [3, 4, 5, 6, 7], "adult": [3, 4, 6], "mous": [3, 4, 6], "coron": [3, 4, 6], "brain": [3, 4, 6], "section": [3, 4, 6], "allen": 3, "alta": 3, "singl": [5, 7], "cell": [5, 7], "resolut": [5, 7], "breast": [5, 7], "cancer": [5, 7], "spatial": [5, 7], "transcriptom": [5, 7], "data": [5, 7], "correspond": 5, "h": 5, "e": 5, "stain": 5, "imag": 5, "from": [4, 5, 6, 7], "xenium": [4, 5, 6, 7], "partial": [6, 7], "match": [6, 7], "serial": 7, "full": 4, "merfish": 4, "starmap": 6}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Aligning adult mouse coronal brain sections with the Allen Brain Altas": [[3, "Aligning-adult-mouse-coronal-brain-sections-with-the-Allen-Brain-Altas"]], "STalign Overview": [[0, "stalign-overview"], [8, "stalign-overview"]], "Overview": [[0, "overview"], [8, "overview"]], "Usage": [[0, "usage"], [8, "usage"]], "Welcome to STalign\u2019s documentation!": [[2, "welcome-to-stalign-s-documentation"]], "Aligning full coronal sections of adult mouse brain from MERFISH and Xenium": [[4, "Aligning-full-coronal-sections-of-adult-mouse-brain-from-MERFISH-and-Xenium"]], "Aligning single-cell resolution breast cancer spatial transcriptomics data to corresponding H&E staining image from Xenium": [[5, "Aligning-single-cell-resolution-breast-cancer-spatial-transcriptomics-data-to-corresponding-H&E-staining-image-from-Xenium"]], "Aligning partially matched coronal sections of adult mouse brain from Xenium and STARmap": [[6, "Aligning-partially-matched-coronal-sections-of-adult-mouse-brain-from-Xenium-and-STARmap"]], "Aligning partially matched, serial, single-cell resolution breast cancer spatial transcriptomics data from Xenium": [[7, "Aligning-partially-matched,-serial,-single-cell-resolution-breast-cancer-spatial-transcriptomics-data-from-Xenium"]], "Tutorials": [[9, "tutorials"]], "Contents:": [[9, null]], "Functions": [[1, "module-STalign"]], "Parameters": [[1, "parameters"], [1, "id3"], [1, "id5"], [1, "id7"], [1, "id9"], [1, "id11"], [1, "id13"], [1, "id15"], [1, "id17"], [1, "id21"], [1, "id26"], [1, "id28"], [1, "id30"], [1, "id32"], [1, "id37"], [1, "id44"], [1, "id46"], [1, "id48"], [1, "id50"], [1, "id52"]], "Returns": [[1, "returns"], [1, "id4"], [1, "id6"], [1, "id8"], [1, "id10"], [1, "id12"], [1, "id14"], [1, "id16"], [1, "id20"], [1, "id24"], [1, "id27"], [1, "id29"], [1, "id31"], [1, "id33"], [1, "id34"], [1, "id38"], [1, "id41"], [1, "id45"], [1, "id47"], [1, "id49"], [1, "id51"], [1, "id53"]], "Examples": [[1, "examples"], [1, "id36"], [1, "id43"]], "Notes": [[1, "notes"], [1, "id25"], [1, "id39"]], "Raises": [[1, "raises"], [1, "id35"], [1, "id42"]], "Paramters": [[1, "paramters"], [1, "id40"]]}, "indexentries": {"lddmm() (in module stalign)": [[1, "STalign.LDDMM"]], "lddmm_3d_to_slice() (in module stalign)": [[1, "STalign.LDDMM_3D_to_slice"]], "l_t_from_points() (in module stalign)": [[1, "STalign.L_T_from_points"]], "stalign": [[1, "module-STalign"]], "analyze3dalign() (in module stalign)": [[1, "STalign.analyze3Dalign"]], "build_transform() (in module stalign)": [[1, "STalign.build_transform"]], "build_transform3d() (in module stalign)": [[1, "STalign.build_transform3D"]], "clip() (in module stalign)": [[1, "STalign.clip"]], "download_aba_image_labels() (in module stalign)": [[1, "STalign.download_aba_image_labels"]], "download_aba_ontology() (in module stalign)": [[1, "STalign.download_aba_ontology"]], "extent_from_x() (in module stalign)": [[1, "STalign.extent_from_x"]], "interp() (in module stalign)": [[1, "STalign.interp"]], "interp3d() (in module stalign)": [[1, "STalign.interp3D"]], "make_scree() (in module stalign)": [[1, "STalign.make_scree"]], "module": [[1, "module-STalign"]], "normalize() (in module stalign)": [[1, "STalign.normalize"]], "plot_brain_regions() (in module stalign)": [[1, "STalign.plot_brain_regions"]], "plot_subset_brain_regions() (in module stalign)": [[1, "STalign.plot_subset_brain_regions"]], "rasterize() (in module stalign)": [[1, "STalign.rasterize"]], "rasterizepca() (in module stalign)": [[1, "STalign.rasterizePCA"]], "rasterize_with_signal() (in module stalign)": [[1, "STalign.rasterize_with_signal"]], "saverasters() (in module stalign)": [[1, "STalign.saveRasters"]], "to_a() (in module stalign)": [[1, "STalign.to_A"]], "to_a_3d() (in module stalign)": [[1, "STalign.to_A_3D"]], "transform_image_atlas_to_target() (in module stalign)": [[1, "STalign.transform_image_atlas_to_target"]], "transform_image_target_to_atlas() (in module stalign)": [[1, "STalign.transform_image_target_to_atlas"]], "transform_points_atlas_to_target() (in module stalign)": [[1, "STalign.transform_points_atlas_to_target"]], "transform_points_target_to_atlas() (in module stalign)": [[1, "STalign.transform_points_target_to_atlas"]], "v_to_phii() (in module stalign)": [[1, "STalign.v_to_phii"]], "v_to_phii_3d() (in module stalign)": [[1, "STalign.v_to_phii_3D"]]}})