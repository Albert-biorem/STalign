Search.setIndex({"docnames": ["README", "STalign", "index", "notebooks/merfish-allen3Datlas-alignment", "notebooks/xenium-heimage-alignment", "notebooks/xenium-xenium-alignment", "overview", "tutorials"], "filenames": ["README.md", "STalign.rst", "index.rst", "notebooks/merfish-allen3Datlas-alignment.ipynb", "notebooks/xenium-heimage-alignment.ipynb", "notebooks/xenium-xenium-alignment.ipynb", "overview.md", "tutorials.rst"], "titles": ["STalign Overview", "Functions", "Welcome to STalign\u2019s documentation!", "Aligning adult mouse coronal brain sections with the Allen Brain Altas", "Aligning single-cell resolution breast cancer spatial transcriptomics data to corresponding H&amp;E staining image from Xenium", "Aligning partially matched, serial, single-cell resolution breast cancer spatial transcriptomics data from Xenium", "STalign Overview", "Tutorials"], "terms": {"tool": [0, 1, 3, 6], "align": [0, 1, 2, 6, 7], "spatial": [0, 1, 2, 3, 6, 7], "transcriptom": [0, 1, 2, 3, 6, 7], "data": [0, 1, 2, 3, 6, 7], "stalign": [1, 3, 4, 5], "lddmm": [1, 2, 4, 5], "xi": [1, 3, 4, 5], "i": [1, 3, 4, 5], "xj": [1, 3, 4, 5], "j": [1, 3, 4, 5], "pointsi": [1, 4, 5], "none": [1, 3], "pointsj": [1, 4, 5], "l": [1, 3, 4, 5], "t": [1, 3, 4, 5], "A": [1, 3, 4, 5], "v": [1, 3, 4, 5], "xv": [1, 3, 4, 5], "500": [1, 4], "0": [1, 3, 4, 5], "p": 1, "2": [1, 3, 4, 5], "expand": 1, "nt": [1, 3], "3": [1, 3, 4, 5], "niter": [1, 3, 4, 5], "5000": 1, "diffeo_start": 1, "epl": 1, "2e": 1, "08": 1, "ept": 1, "epv": [1, 4, 5], "2000": [1, 4], "sigmam": [1, 3, 4, 5], "1": [0, 1, 3, 4, 5, 6], "sigmab": [1, 3, 4, 5], "sigmaa": [1, 3, 4, 5], "5": [1, 3, 4, 5], "sigmar": 1, "500000": 1, "sigmap": 1, "20": [1, 3], "devic": [1, 3, 4, 5], "cpu": [1, 3, 4, 5], "dtype": [1, 3], "torch": [1, 3, 4, 5], "float64": [1, 3], "mub": [1, 3, 4], "mua": [1, 3, 4], "run": [1, 4, 5], "between": [1, 3, 4], "pair": 1, "imag": [1, 2, 3, 5, 7], "thi": [1, 3, 4, 5], "jointli": 1, "estim": 1, "an": [1, 3, 4, 5], "affin": [1, 3, 4, 5], "transform": [1, 3, 4, 5], "diffeomorph": [0, 1, 6], "phi": [1, 4, 5], "The": [1, 3], "map": [0, 1, 3, 6], "off": 1, "form": 1, "x": [1, 3, 4, 5], "list": [1, 3, 5], "tensor": [1, 3, 4, 5], "locat": [1, 3], "voxel": 1, "atla": [1, 3, 4], "channel": 1, "along": [1, 3, 4, 5], "first": [1, 3, 4, 5], "axi": 1, "target": [1, 3, 4, 5], "initi": [1, 3, 4, 5], "guess": [1, 3], "linear": [1, 4, 5], "2x2": 1, "default": [1, 3, 4, 5], "ident": [1, 3], "translat": [1, 4], "element": 1, "matrix": [1, 4, 5], "either": [1, 4], "can": [1, 3, 4, 5], "specifi": [1, 3], "both": [1, 3, 5], "veloc": [1, 3], "field": 1, "pixel": [1, 3], "float": 1, "smooth": [1, 3], "scale": [1, 3, 4, 5], "200": [1, 3, 5], "power": 1, "laplacian": 1, "regular": 1, "factor": 1, "size": [1, 3, 4], "around": [1, 3], "boundari": 1, "int": 1, "number": [1, 3], "timestep": 1, "integr": 1, "ignor": [1, 3], "you": [1, 3, 4, 5], "input": 1, "n": [1, 3], "set": [1, 3, 4, 5], "correspond": [1, 2, 3, 7], "point": [1, 3, 4, 5], "match": [1, 2, 3, 7], "iter": [1, 3], "gradient": [1, 3, 4, 5], "descent": [1, 3, 4, 5], "optim": 1, "onli": [1, 3, 4, 5], "befor": 1, "nonlinear": 1, "deform": [1, 4, 5], "step": [1, 3], "part": 1, "standard": [1, 3], "deviat": [1, 3], "term": 1, "gaussian": 1, "mixtur": 1, "model": [1, 3], "cost": 1, "gener": [1, 4, 5], "control": 1, "accuraci": [1, 3, 4, 5], "smaller": 1, "more": [1, 3, 4, 5], "accur": 1, "As": 1, "common": [0, 1, 6], "rule": 1, "thumb": 1, "could": 1, "chose": 1, "varianc": [1, 4], "your": [1, 3, 4, 5], "backtround": 1, "If": [1, 3], "miss": 1, "tissu": [1, 3, 4, 5], "we": [1, 3, 4, 5], "mai": [1, 5], "label": [1, 3], "some": [1, 4], "background": [1, 3, 4], "enforc": 1, "here": [1, 3], "artifact": [1, 3, 4], "ar": [1, 3, 4, 5], "other": [1, 3, 4, 5], "lack": 1, "templat": 1, "mean": [1, 3], "smoother": 1, "result": [1, 3, 4, 5], "int_0": 1, "int_x": 1, "lv": 1, "dx": [1, 3, 4, 5], "dt": 1, "sum_i": 1, "atlas_point_i": 1, "target_point_i": 1, "str": 1, "also": [1, 3, 4, 5], "cuda": 1, "type": [1, 3], "whose": 1, "dimens": 1, "same": [1, 4, 5], "which": [1, 3, 5], "provid": [1, 5], "valu": [1, 3, 4, 5], "rgb": [1, 4, 5], "should": [1, 3], "grayscal": 1, "includ": 1, "done": [1, 4], "metric": [0, 1, 6], "better": 1, "mu": 1, "lddmm_3d_to_slic": [1, 2, 3], "25": [1, 3], "1e": 1, "06": [1, 4, 5], "10": [1, 3, 4, 5], "1000": [1, 5], "100000000": 1, "3d": [0, 1, 3, 6], "2d": 1, "slice": [1, 3], "check": [1, 4, 5], "convert": [1, 3, 5], "semilagrang": 1, "l_t_from_point": [1, 2, 3, 4, 5], "comput": [1, 4, 5], "from": [1, 2, 3, 7], "6dof": 1, "need": [1, 3, 4, 5], "output": [1, 4, 5], "rconstruct": 1, "blockwiz": 1, "like": [1, 3, 4], "arrai": [1, 3, 4, 5], "nx2": 1, "describ": 1, "row": [1, 3], "col": 1, "order": [1, 3, 5], "xy": 1, "vector": 1, "build_transform": [1, 2, 4, 5], "direct": [1, 3, 4, 5], "b": [1, 5], "creat": [1, 3, 4, 5], "sampl": [1, 4, 5], "time": [1, 4], "depend": [1, 3, 4, 5], "char": 1, "f": [1, 4, 5], "forward": 1, "backward": 1, "us": [0, 1, 3, 4, 5, 6], "meshgrid": [1, 3], "ij": [1, 3], "index": [1, 3], "style": 1, "keep": [1, 4, 5], "mehsgrid": 1, "format": [1, 3], "implement": 1, "versu": 1, "build_transform3d": [1, 2], "IN": 1, "progress": 1, "clip": [1, 2], "visual": [1, 3, 4, 5], "ic": 1, "extent_from_x": [1, 2, 3, 4, 5], "given": [1, 5], "extent": [1, 3, 4, 5], "4": [1, 3, 4, 5], "tupl": 1, "np": [1, 3, 4, 5], "imshow": [1, 3, 4, 5], "each": [1, 3, 5], "e": [1, 2, 7], "column": [1, 3], "xmin": 1, "xmax": 1, "ymin": 1, "ymax": 1, "fig": [0, 1, 3, 4, 5, 6], "ax": [1, 3, 4, 5], "plt": [1, 3, 4, 5], "subplot": [1, 3, 4, 5], "extentj": [1, 4, 5], "interp": [1, 2], "phii": [1, 5], "kwarg": [1, 3], "interpol": 1, "grid": [1, 5], "posit": [1, 3, 4, 5], "store": [1, 3, 5], "1d": [1, 4], "compon": 1, "convent": 1, "contain": [1, 3], "differ": 1, "dict": 1, "argument": [1, 3], "fed": 1, "nn": [1, 3], "grid_sampl": [1, 3], "out": [1, 4, 5], "resampl": 1, "defin": [1, 3], "align_corn": 1, "true": [1, 3, 4, 5], "librari": [1, 3, 4, 5], "interp3d": [1, 2, 3], "4d": 1, "make_scre": [1, 2], "w": [1, 3], "name": 1, "6": [1, 3], "scree": 1, "plot": [1, 3, 4, 5], "eigenvalu": 1, "numpi": [1, 3, 4, 5], "descend": 1, "dataset": [0, 1, 3, 4, 5, 6], "origin": [1, 3, 4, 5], "Will": 1, "titl": [1, 3], "matplotlib": [1, 3, 4, 5], "figur": [1, 3, 4, 5], "handl": 1, "valueerror": 1, "larger": 1, "than": [1, 3, 4, 5], "normal": [1, 2, 4], "arr": 1, "t_min": 1, "t_max": 1, "linearli": 1, "two": [1, 3, 4, 5], "specif": 1, "lower": [1, 3], "bound": 1, "rang": [1, 3, 4, 5], "upper": [1, 3, 4, 5], "norm_arr": 1, "raster": [1, 2, 3, 4, 5], "y": [1, 3, 4, 5], "g": [1, 4, 5], "30": [1, 4, 5], "blur": [1, 3], "draw": [1, 3], "10000": [1, 4, 5], "wavelet_magnitud": 1, "fals": [1, 3], "use_window": 1, "densiti": [1, 3, 4, 5], "length": 1, "cell": [0, 1, 2, 3, 6, 7], "rna": 1, "count": 1, "unit": [1, 3, 4, 5], "kernel": 1, "aus": 1, "do": 1, "multi": 1, "area": 1, "beyond": 1, "everi": 1, "its": 1, "bool": 1, "take": [1, 3, 4, 5], "absolut": 1, "when": 1, "option": [1, 3, 5], "sort": 1, "greatest": 1, "least": 1, "m": [1, 4, 5], "len": 1, "drawn": 1, "except": 1, "micron": [1, 4, 5], "three": 1, "rasterizepca": [1, 2], "perform": [1, 3, 4, 5], "pca": 1, "panda": [1, 3, 4, 5], "datafram": 1, "shape": [1, 3, 4, 5], "gene": 1, "express": [1, 3], "level": [1, 4, 5], "unravel": 1, "d": [1, 3], "center": 1, "princip": 1, "eigenvector": 1, "z": [1, 3], "rotat": [1, 3], "nrow": 1, "ncol": 1, "all": [1, 3, 4, 5], "rasterize_with_sign": [1, 2], "": [1, 3, 4, 5], "signal": 1, "nxm": 1, "last": 1, "saverast": [1, 2], "scree_fig": 1, "path": [1, 3, 4, 5], "save": [1, 3, 4, 5], "necessari": 1, "jpeg": 1, "folder": [1, 3, 4, 5], "where": [1, 3], "file": [1, 3, 4, 5], "to_a": [1, 2], "NOT": 1, "2x1": 1, "to_a_3d": [1, 2], "3x3": 1, "transform_image_atlas_to_target": [1, 2, 5], "transform_image_target_to_atla": [1, 2, 4, 5], "transform_points_atlas_to_target": [1, 2, 5], "transform_points_target_to_atla": [1, 2, 4, 5], "v_to_phii": [1, 2], "over": 1, "5d": 1, "v0": 1, "v1": 1, "invers": 1, "method": 1, "characterist": 1, "v_to_phii_3d": [1, 2], "v2": [1, 3], "overview": 2, "usag": [2, 5], "tutori": 2, "function": [2, 3], "python": [0, 5, 6], "st": [0, 6], "biorxiv": [0, 4, 5, 6], "link": [0, 3, 6], "enabl": [0, 6], "singl": [0, 2, 3, 6, 7], "resolut": [0, 2, 3, 6, 7], "within": [0, 6], "technologi": [0, 3, 4, 5, 6], "histologi": [0, 6], "across": [0, 4, 6], "coordin": [0, 4, 5, 6], "framework": [0, 6], "To": [0, 3, 4, 5, 6], "pleas": [0, 6], "refer": [0, 3, 6], "follow": [0, 3, 5, 6], "jupytr": [0, 6], "notebook": [0, 3, 4, 5, 6], "exampl": [0, 3, 6], "partial": [2, 7], "serial": [2, 3, 7], "breast": [2, 3, 7], "cancer": [2, 3, 7], "xenium": [2, 3, 7], "In": [3, 4, 5], "profil": [3, 4, 5], "them": [3, 4, 5], "download": [3, 4, 5], "addit": 3, "merfish": 3, "find": 3, "detail": [3, 4, 5], "about": [3, 4, 5], "http": [3, 4, 5], "info": 3, "vizgen": 3, "com": [3, 4, 5], "achiev": [3, 4, 5], "load": [3, 4, 5], "relev": [3, 4, 5], "code": [3, 4, 5], "import": [3, 4, 5], "pyplot": [3, 4, 5], "pd": [3, 4, 5], "csv": [3, 4, 5], "cm": 3, "line": [3, 4, 5], "line2d": 3, "o": 3, "exist": 3, "split": 3, "join": 3, "splitext": 3, "makedir": 3, "glob": 3, "request": 3, "collect": [3, 4, 5], "defaultdict": 3, "nrrd": 3, "tornado": 3, "sy": [3, 4, 5], "insert": 3, "py": [3, 4, 5], "copi": [3, 4, 5], "have": [3, 4, 5], "alreadi": [3, 4, 5], "found": 3, "abov": 3, "call": [3, 4, 5], "merfish_data": 3, "now": [3, 4, 5], "read": [3, 4, 5], "infom": 3, "must": 3, "variabl": 3, "respect": [3, 5], "importantli": 3, "approxim": 3, "um": [3, 4, 5], "filenam": 3, "__": 3, "df": [3, 4], "read_csv": [3, 4, 5], "s1r1_metadata": 3, "gz": [3, 4, 5], "center_x": 3, "chang": 3, "center_i": 3, "ontologi": 3, "region": 3, "annot": 3, "aforement": 3, "would": 3, "url": 3, "p56": 3, "api": 3, "org": [3, 4, 5], "queri": 3, "criteria": 3, "structur": 3, "rma": 3, "ontology_id": 3, "eq1": 3, "eq": 3, "27structur": 3, "graph_ord": 3, "27": 3, "num_row": 3, "eqal": 3, "ontology_nam": 3, "namesdict": 3, "download_aba_ontologi": 3, "allen_ontologi": 3, "lt": [3, 4, 5], "respons": 3, "gt": [3, 4, 5], "7": 3, "imageurl": 3, "alleninstitut": 3, "informat": 3, "archiv": 3, "current": 3, "releas": 3, "mouse_ccf": 3, "ara_nissl": 3, "ara_nissl_50": 3, "labelurl": 3, "ccf_2017": 3, "annotation_50": 3, "imagefil": 3, "labelfil": 3, "download_aba_image_label": 3, "aba_nissl": 3, "aba_annot": 3, "our": [3, 4, 5], "centroid": [3, 4, 5], "For": [3, 4, 5], "choos": 3, "15": [3, 4], "8": 3, "x_": 3, "y_": 3, "9": 3, "unraster": 3, "scatter": [3, 4, 5], "alpha": [3, 4, 5], "invert_yaxi": [3, 4, 5], "set_titl": [3, 4, 5], "set_aspect": [3, 4, 5], "equal": [3, 4, 5], "canva": 3, "savefig": 3, "outnam": 3, "_imag": 3, "png": [3, 4], "text": [3, 4, 5], "39": [3, 4, 5], "evalu": [3, 4, 5], "whether": [3, 4, 5], "similar": [3, 4], "view": 3, "side": 3, "comparison": 3, "aba": 3, "anterior": 3, "264": 3, "posterior": 3, "perus": 3, "through": 3, "177": 3, "vol": 3, "hdr": 3, "dxa": 3, "diag": 3, "space": 3, "nxa": 3, "xa": 3, "arang": [3, 4, 5], "zip": 3, "extenta": 3, "next": [3, 4, 5], "angl": 3, "theta_deg": 3, "note": [3, 4, 5], "degre": 3, "11": [3, 4], "scipi": 3, "ndimag": 3, "ani": [3, 4], "eachoth": 3, "add": 3, "help": [3, 5], "speed": 3, "up": 3, "12": [3, 4, 5], "points_atla": 3, "2580": 3, "points_target": 3, "2533": 3, "li": 3, "ti": 3, "well": [3, 5], "13": 3, "ab": 3, "keepdim": 3, "concaten": 3, "chosen": 3, "readi": 3, "paramet": [3, 4, 5], "relat": 3, "14": 3, "intens": [3, 4], "inten": 3, "averag": 3, "look": [3, 4, 5], "histogram": 3, "below": 3, "consid": 3, "present": 3, "absent": 3, "usual": 3, "doe": 3, "hist": 3, "ravel": 3, "xlabel": 3, "ylabel": 3, "vari": 3, "durat": 3, "ensur": 3, "invert": [3, 4, 5], "minimum": 3, "error": 3, "16": [3, 4], "scale_x": 3, "scale_i": 3, "scale_z": 3, "theta0": 3, "pi": 3, "180": [3, 4, 5], "get": [3, 4, 5], "local": [3, 4, 5], "els": 3, "scale_atla": 3, "co": 3, "sin": 3, "matmul": 3, "17": 3, "return": 3, "mat": 3, "home": 3, "manju": 3, "anaconda3": 3, "env": 3, "stalign_ma": 3, "lib": 3, "python3": 3, "site": 3, "packag": 3, "504": 3, "userwarn": [3, 4, 5], "upcom": 3, "requir": 3, "pass": 3, "trigger": 3, "intern": 3, "aten": 3, "src": 3, "nativ": 3, "tensorshap": 3, "cpp": 3, "3190": 3, "_vf": 3, "attr": 3, "document": 3, "1619": 3, "ha": [3, 4, 5], "therefor": [3, 4, 5], "cannot": [3, 4, 5], "log": [3, 4, 5], "set_yscal": [3, 4, 5], "onc": 3, "project": 3, "export": 3, "inform": [3, 4, 5], "18": 3, "analyze3dalign": 3, "1726": 3, "construct": [3, 4, 5], "recommend": [3, 4, 5], "sourcetensor": [3, 4, 5], "clone": [3, 4, 5], "detach": [3, 4, 5], "requires_grad_": [3, 4, 5], "rather": [3, 4, 5], "1727": 3, "1739": 3, "19": 3, "coord0": 3, "coord1": 3, "coord2": 3, "struct_id": 3, "acronym": 3, "2539": 3, "515486": 3, "603": 3, "193661": 3, "5240": 3, "542771": 3, "156": 3, "563284": 3, "4271": 3, "326432": 3, "bg": 3, "647117": 3, "592": 3, "013787": 3, "662749": 3, "509284": 3, "4256": 3, "962431": 3, "2540": 3, "042012": 3, "558": 3, "474157": 3, "5241": 3, "022683": 3, "159": 3, "965284": 3, "4228": 3, "180431": 3, "2538": 3, "604705": 3, "670": 3, "107819": 3, "5228": 3, "182084": 3, "167": 3, "579284": 3, "4323": 3, "868433": 3, "988970": 3, "647": 3, "913143": 3, "062863": 3, "160": 3, "559284": 3, "4308": 3, "802433": 3, "78324": 3, "2422": 3, "949259": 3, "666": 3, "416827": 3, "5225": 3, "134162": 3, "9154": 3, "007886": 3, "4445": 3, "528506": 3, "78325": 3, "2423": 3, "861142": 3, "644": 3, "950717": 3, "5155": 3, "140278": 3, "9088": 3, "829884": 3, "4423": 3, "712505": 3, "78326": 3, "014052": 3, "643": 3, "726655": 3, "5248": 3, "138969": 3, "9170": 3, "261887": 3, "4431": 3, "758506": 3, "78327": 3, "999558": 3, "633": 3, "758279": 3, "017523": 3, "9086": 3, "183884": 3, "4417": 3, "016505": 3, "78328": 3, "2424": 3, "194181": 3, "634": 3, "061413": 3, "5131": 3, "766050": 3, "9073": 3, "169884": 3, "4419": 3, "770505": 3, "78329": 3, "explor": 3, "overlai": 3, "It": 3, "ai": 3, "permut": [3, 4, 5], "padding_mod": 3, "border": 3, "ishow_sourc": 3, "amin": 3, "amax": 3, "jt": 3, "ishow_target": 3, "max": [3, 4, 5], "item": 3, "mpl": 3, "figsiz": [3, 4, 5], "ax0": 3, "cmap": 3, "blue": 3, "ax1": 3, "red": [3, 4, 5], "ax2": 3, "show": [3, 4, 5], "curv": 3, "captur": 3, "trueli": 3, "natur": [3, 4], "21": 3, "plotli": 3, "graph_obj": 3, "go": 3, "px": 3, "scatter_3d": 3, "update_layout": 3, "update_xax": 3, "show_grid": 3, "update_yax": 3, "update_trac": 3, "marker_s": 3, "22": 3, "plot_brain_region": 3, "interest": 3, "few": [3, 5], "let": 3, "visp4": 3, "visp5": 3, "those": 3, "24": [3, 4, 5], "brain_region": 3, "plot_subset_brain_region": 3, "section": [2, 4, 5, 7], "see": [4, 5], "preprint": [4, 5], "www": [4, 5], "content": [4, 5], "1101": [4, 5], "2022": [4, 5], "510405v2": [4, 5], "accord": 4, "author": 4, "due": 4, "non": [4, 5], "destruct": 4, "workflow": 4, "were": [4, 5], "abl": 4, "post": 4, "process": 4, "howev": 4, "wa": 4, "seprat": 4, "still": [4, 5], "regist": 4, "directori": [4, 5], "skip": [4, 5], "append": [4, 5], "make": [4, 5], "bigger": [4, 5], "rcparam": [4, 5], "place": [4, 5], "xenium_data": [4, 5], "10xgenom": [4, 5], "product": [4, 5], "situ": [4, 5], "preview": [4, 5], "human": [4, 5], "73": [4, 5], "image_fil": 4, "xenium_ffpe_human_breast_cancer_rep1_he_imag": 4, "imread": 4, "axesimag": 4, "0x7f813041e040": 4, "had": 4, "nxmx3": 4, "74": [4, 5], "print": [4, 5], "min": 4, "2051": 4, "2759": 4, "case": 4, "outlier": 4, "75": [4, 5], "inorm": 4, "0x7f81115c3490": 4, "transpos": [4, 5], "3xnxm": 4, "downstream": [4, 5], "analys": 4, "yi": [4, 5], "track": 4, "76": 4, "long": 4, "doubl": [4, 5], "later": [4, 5], "so": [4, 5], "multipli": 4, "extenti": [4, 5], "77": 4, "fname": [4, 5], "xenium_ffpe_human_breast_cancer_rep1_cel": [4, 5], "head": [4, 5], "cell_id": [4, 5], "x_centroid": [4, 5], "y_centroid": [4, 5], "transcript_count": [4, 5], "control_probe_count": [4, 5], "control_codeword_count": [4, 5], "total_count": [4, 5], "cell_area": [4, 5], "nucleus_area": [4, 5], "377": [4, 5], "663005": [4, 5], "843": [4, 5], "541888": [4, 5], "154": [4, 5], "110": [4, 5], "361875": [4, 5], "45": [4, 5], "562656": [4, 5], "382": [4, 5], "078658": [4, 5], "858": [4, 5], "944818": [4, 5], "64": [4, 5], "87": [4, 5], "919219": [4, 5], "248906": [4, 5], "319": [4, 5], "839529": [4, 5], "869": [4, 5], "196542": [4, 5], "57": [4, 5], "52": [4, 5], "561875": [4, 5], "23": [4, 5], "526406": [4, 5], "259": [4, 5], "304707": [4, 5], "851": [4, 5], "797949": [4, 5], "120": [4, 5], "230312": [4, 5], "35": [4, 5], "176719": [4, 5], "370": [4, 5], "576291": [4, 5], "865": [4, 5], "193024": [4, 5], "218594": [4, 5], "34": [4, 5], "499375": [4, 5], "pull": [4, 5], "further": [4, 5], "sens": [4, 5], "variat": [4, 5], "reli": [4, 5], "89": 4, "xm": 4, "ym": 4, "pathcollect": [4, 5], "0x7f80d0d39f40": 4, "94": 4, "0x7f8132312ac0": 4, "begin": 4, "assum": [4, 5], "bottom": [4, 5], "left": [4, 5], "while": [4, 5], "typic": [4, 5], "top": [4, 5], "ve": [4, 5], "yaxi": [4, 5], "consist": [4, 5], "80": 4, "30um": [4, 5], "yj": [4, 5], "167782": [4, 5], "20000": [4, 5], "30000": [4, 5], "40000": [4, 5], "50000": [4, 5], "60000": [4, 5], "70000": [4, 5], "80000": [4, 5], "90000": [4, 5], "100000": [4, 5], "110000": [4, 5], "120000": [4, 5], "130000": [4, 5], "140000": [4, 5], "150000": [4, 5], "160000": [4, 5], "167781": [4, 5], "greyscal": [4, 5], "simpli": 4, "stack": [4, 5], "81": 4, "vstack": [4, 5], "thing": 4, "201": 4, "276": 4, "134067631252947": 4, "inter": [4, 5], "somewhat": [4, 5], "slow": [4, 5], "manual": [4, 5], "mark": 4, "landmark": [4, 5], "simpl": [4, 5], "sensibl": [4, 5], "197": 4, "1050": 4, "950": 4, "700": 4, "2200": 4, "1550": 4, "1840": 4, "3108": 4, "2100": 4, "4480": 4, "6440": 4, "5040": 4, "4200": 4, "1260": 4, "5320": 4, "squeez": [4, 5], "c": [4, 5], "198": 4, "base": 4, "appli": [4, 5], "deriv": 4, "linalg": 4, "inv": 4, "shift": 4, "neg": 4, "subtract": 4, "instead": [4, 5], "ad": 4, "199": 4, "dot": 4, "xmaffin": 4, "ymaffin": 4, "65041156": 4, "06574554": 4, "11365427": 4, "50866925": 4, "6832": 4, "39702429": 4, "1329": 4, "64577839": 4, "0x7f80c939b790": 4, "seem": 4, "distort": [4, 5], "introduc": 4, "dure": 4, "suffici": [4, 5], "via": [4, 5], "There": [4, 5], "mani": [4, 5], "tune": [4, 5], "84": 4, "my": [4, 5], "desktop": [4, 5], "param": [4, 5], "black": 4, "white": 4, "1283": [4, 5], "throughout": [4, 5], "give": [4, 5], "choic": [4, 5], "appropri": [4, 5], "converg": [4, 5], "solut": [4, 5], "how": [4, 5], "sourc": [4, 5], "85": 4, "phiij": [4, 5], "phiipointsj": [4, 5], "contour": [4, 5], "color": [4, 5], "r": [4, 5], "linestyl": [4, 5], "1638": [4, 5], "1639": [4, 5], "1651": [4, 5], "0x7f80c1a66340": 4, "final": [4, 5], "new": [4, 5], "86": 4, "tpointsi": [4, 5], "And": [4, 5], "0x7f81115e88b0": 4, "hstack": [4, 5], "savetxt": [4, 5], "88": 4, "xenium_breast_cancer_rep1_stalign_to_h": 4, "delimit": [4, 5], "gzip": [4, 5], "compress": [4, 5], "51": 5, "df1": 5, "0x7f7d18cb0d00": 5, "54": 5, "repeat": 5, "second": 5, "xenium_ffpe_human_breast_cancer_rep2_cel": 5, "df2": 5, "ff7f0e": 5, "118752": 5, "118751": 5, "79": 5, "0x7f7cc8a3ed30": 5, "design": 5, "curve_annot": 5, "script": 5, "assist": 5, "write": 5, "npz": 5, "picker": 5, "savez": 5, "xenium_breast_cancer_rep1": 5, "xenium_breast_cancer_rep2": 5, "graphic": 5, "user": 5, "interfac": 5, "select": 5, "xenium_breast_cancer_rep1_point": 5, "npy": 5, "xenium_breast_cancer_rep2_point": 5, "58": 5, "pointsilist": 5, "allow_pickl": 5, "tolist": 5, "pointsjlist": 5, "2065": 5, "0390375683187": 5, "3096": 5, "538441761356": 5, "6505": 5, "52290853606": 5, "4365": 5, "248119180711": 5, "4226": 5, "85355369735": 5, "4932": 5, "828764342001": 5, "2365": 5, "8569852416354": 5, "1218": 5, "8582693193312": 5, "6839": 5, "7279529835705": 5, "2387": 5, "4066564161058": 5, "4552": 5, "711823951313": 5, "3046": 5, "801817706428": 5, "want": 5, "59": 5, "jean": 5, "bit": 5, "odd": 5, "me": 5, "orient": 5, "kei": 5, "60": 5, "53844176": 5, "03903757": 5, "24811918": 5, "52290854": 5, "82876434": 5, "8535537": 5, "85826932": 5, "85698524": 5, "40665642": 5, "72795298": 5, "80181771": 5, "71182395": 5, "altern": 5, "just": 5, "But": 5, "good": 5, "61": 5, "201x276": 5, "62": 5, "63": 5, "100": 5, "ifoo": 5, "jfoo": 5, "phipointsi": 5, "becaus": 5, "65": 5, "66": 5, "tpointsj": 5, "67": 5, "0x7f7d1867a400": 5, "68": 5, "xenium_breast_cancer_rep2_stalign_to_rep1": 5, "h": [2, 7], "stain": [2, 7], "adult": [2, 7], "mous": [2, 7], "coron": [2, 7], "brain": [2, 7], "allen": [2, 7], "alta": [2, 7], "oct": []}, "objects": {"": [[1, 0, 0, "-", "STalign"]], "STalign": [[1, 1, 1, "", "LDDMM"], [1, 1, 1, "", "LDDMM_3D_to_slice"], [1, 1, 1, "", "L_T_from_points"], [1, 1, 1, "", "build_transform"], [1, 1, 1, "", "build_transform3D"], [1, 1, 1, "", "clip"], [1, 1, 1, "", "extent_from_x"], [1, 1, 1, "", "interp"], [1, 1, 1, "", "interp3D"], [1, 1, 1, "", "make_scree"], [1, 1, 1, "", "normalize"], [1, 1, 1, "", "rasterize"], [1, 1, 1, "", "rasterizePCA"], [1, 1, 1, "", "rasterize_with_signal"], [1, 1, 1, "", "saveRasters"], [1, 1, 1, "", "to_A"], [1, 1, 1, "", "to_A_3D"], [1, 1, 1, "", "transform_image_atlas_to_target"], [1, 1, 1, "", "transform_image_target_to_atlas"], [1, 1, 1, "", "transform_points_atlas_to_target"], [1, 1, 1, "", "transform_points_target_to_atlas"], [1, 1, 1, "", "v_to_phii"], [1, 1, 1, "", "v_to_phii_3D"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"function": 1, "paramet": 1, "return": 1, "todo": 1, "exampl": 1, "note": 1, "rais": 1, "paramt": 1, "welcom": 2, "stalign": [0, 2, 6], "": 2, "document": 2, "content": 7, "overview": [0, 6], "usag": [0, 6], "tutori": 7, "align": [3, 4, 5], "adult": 3, "mous": 3, "coron": 3, "brain": 3, "section": 3, "allen": 3, "alta": 3, "singl": [4, 5], "cell": [4, 5], "resolut": [4, 5], "breast": [4, 5], "cancer": [4, 5], "spatial": [4, 5], "transcriptom": [4, 5], "data": [4, 5], "correspond": 4, "h": 4, "e": 4, "stain": 4, "imag": 4, "from": [4, 5], "xenium": [4, 5], "partial": 5, "match": 5, "serial": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"STalign Overview": [[0, "stalign-overview"], [6, "stalign-overview"]], "Overview": [[0, "overview"], [6, "overview"]], "Usage": [[0, "usage"], [6, "usage"]], "Functions": [[1, "module-STalign"]], "Parameters": [[1, "parameters"], [1, "id4"], [1, "id6"], [1, "id9"], [1, "id12"], [1, "id14"], [1, "id16"], [1, "id20"], [1, "id25"], [1, "id27"], [1, "id32"], [1, "id39"], [1, "id41"], [1, "id43"], [1, "id45"], [1, "id47"]], "Returns": [[1, "returns"], [1, "id5"], [1, "id7"], [1, "id10"], [1, "id13"], [1, "id15"], [1, "id19"], [1, "id23"], [1, "id26"], [1, "id28"], [1, "id29"], [1, "id33"], [1, "id36"], [1, "id40"], [1, "id42"], [1, "id44"], [1, "id46"], [1, "id48"]], "TODO": [[1, "todo"], [1, "id3"], [1, "id8"], [1, "id11"]], "Examples": [[1, "examples"], [1, "id31"], [1, "id38"]], "Notes": [[1, "notes"], [1, "id24"], [1, "id34"]], "Raises": [[1, "raises"], [1, "id30"], [1, "id37"]], "Paramters": [[1, "paramters"], [1, "id35"]], "Welcome to STalign\u2019s documentation!": [[2, "welcome-to-stalign-s-documentation"]], "Aligning adult mouse coronal brain sections with the Allen Brain Altas": [[3, "Aligning-adult-mouse-coronal-brain-sections-with-the-Allen-Brain-Altas"]], "Aligning single-cell resolution breast cancer spatial transcriptomics data to corresponding H&E staining image from Xenium": [[4, "Aligning-single-cell-resolution-breast-cancer-spatial-transcriptomics-data-to-corresponding-H&E-staining-image-from-Xenium"]], "Aligning partially matched, serial, single-cell resolution breast cancer spatial transcriptomics data from Xenium": [[5, "Aligning-partially-matched,-serial,-single-cell-resolution-breast-cancer-spatial-transcriptomics-data-from-Xenium"]], "Tutorials": [[7, "tutorials"]], "Contents:": [[7, null]]}, "indexentries": {"lddmm() (in module stalign)": [[1, "STalign.LDDMM"]], "lddmm_3d_to_slice() (in module stalign)": [[1, "STalign.LDDMM_3D_to_slice"]], "l_t_from_points() (in module stalign)": [[1, "STalign.L_T_from_points"]], "stalign": [[1, "module-STalign"]], "build_transform() (in module stalign)": [[1, "STalign.build_transform"]], "build_transform3d() (in module stalign)": [[1, "STalign.build_transform3D"]], "clip() (in module stalign)": [[1, "STalign.clip"]], "extent_from_x() (in module stalign)": [[1, "STalign.extent_from_x"]], "interp() (in module stalign)": [[1, "STalign.interp"]], "interp3d() (in module stalign)": [[1, "STalign.interp3D"]], "make_scree() (in module stalign)": [[1, "STalign.make_scree"]], "module": [[1, "module-STalign"]], "normalize() (in module stalign)": [[1, "STalign.normalize"]], "rasterize() (in module stalign)": [[1, "STalign.rasterize"]], "rasterizepca() (in module stalign)": [[1, "STalign.rasterizePCA"]], "rasterize_with_signal() (in module stalign)": [[1, "STalign.rasterize_with_signal"]], "saverasters() (in module stalign)": [[1, "STalign.saveRasters"]], "to_a() (in module stalign)": [[1, "STalign.to_A"]], "to_a_3d() (in module stalign)": [[1, "STalign.to_A_3D"]], "transform_image_atlas_to_target() (in module stalign)": [[1, "STalign.transform_image_atlas_to_target"]], "transform_image_target_to_atlas() (in module stalign)": [[1, "STalign.transform_image_target_to_atlas"]], "transform_points_atlas_to_target() (in module stalign)": [[1, "STalign.transform_points_atlas_to_target"]], "transform_points_target_to_atlas() (in module stalign)": [[1, "STalign.transform_points_target_to_atlas"]], "v_to_phii() (in module stalign)": [[1, "STalign.v_to_phii"]], "v_to_phii_3d() (in module stalign)": [[1, "STalign.v_to_phii_3D"]]}})